# Calcimpy Basics

## Goal

管入り口での音響インピーダンスを計算するプログラムをpythonで書く。

管の内径分布は、XMEN形式で与える。



## XMEN FILE

### 基本

ベルのような任意の広がり形状において、軸線に沿って十分小さい距離で分割すれば、その内径分布は薄い円錐によって近似できる。
図の実線で区切られた部分がその例となる。

![bell.png](bell.png)

各小部分は入口径(df)、出口径(db)、距離(l)の3要素で表現できる。

直管部分も含めて、内径分布(Mensur)は次のような数値列で表現できる。
```
df1,db1,l1
df2,db2,l2
df3,db3,l3
...
```

### 音孔, 横穴

木管楽器の音孔や金管楽器の唾抜き孔のように、管路の途中に横穴が明いていることがある。
キーで閉じている場合でも、横に向かって立ち上がった短い管路が結合されていることになるので、その効果を計算に入れるのが良い。

![tonehole.png](tonehole.png)

各枝での音響インピーダンスをz1,z2とすれば合流地点でのzは、

$$
\frac{1}{z} = \frac{1}{z_1} + \frac{1}{z_2}
$$

となる。

### 分岐, バルブの迂回路

金管楽器のバルブ装置で管路が切り替わる際、中間状態では2つ以上の管路が複合される。
ハーフバルブ演奏時の音響インピーダンスを計算するために、複合管路を計算できる必要がある。

![loop.png](loop.png)

この場合の合流地点でのインピーダンス計算は
[loop_impedance.nb.pdf](loop_impedance.nb.pdf)を参照。

